<!doctype html><html lang="en" data-mode="light"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="Wish I Knew How to Sort (an exercise in probability)" /><meta name="author" content="Viktória Nemkin" /><meta property="og:locale" content="en" /><meta name="description" content="In this post I would like to talk about solving Codeforces 1753C: Wish I Knew How to Sort." /><meta property="og:description" content="In this post I would like to talk about solving Codeforces 1753C: Wish I Knew How to Sort." /><link rel="canonical" href="https://vprog.hu/posts/2022-04-12-wish-i-knew-how-to-sort/" /><meta property="og:url" content="https://vprog.hu/posts/2022-04-12-wish-i-knew-how-to-sort/" /><meta property="og:site_name" content="VProg" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-04-12T13:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Wish I Knew How to Sort (an exercise in probability)" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Viktória Nemkin","url":"https://cs.bme.hu/~nemkin"},"dateModified":"2022-04-12T13:00:00+02:00","datePublished":"2022-04-12T13:00:00+02:00","description":"In this post I would like to talk about solving Codeforces 1753C: Wish I Knew How to Sort.","headline":"Wish I Knew How to Sort (an exercise in probability)","mainEntityOfPage":{"@type":"WebPage","@id":"https://vprog.hu/posts/2022-04-12-wish-i-knew-how-to-sort/"},"url":"https://vprog.hu/posts/2022-04-12-wish-i-knew-how-to-sort/"}</script><title>Wish I Knew How to Sort (an exercise in probability) | VProg</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="VProg"><meta name="application-name" content="VProg"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.1/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" style="display:block"> <img src="/assets/img/balloons-cartoon.png" width="100%" alt="avatar" onerror="this.style.display='none'"> </a><h1 class="site-title"> <a href="/">VProg</a></h1><p class="site-subtitle fst-italic mb-0">Competitive programming student club at BME VIK SZIT. ICPC, Codeforces, LeetCode, etc.</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/news" class="nav-link"> <i class="fa-fw fas fa-newspaper"></i> <span>NEWS</span> </a><li class="nav-item"> <a href="/student-club/" class="nav-link"> <i class="fa-fw fa-solid fa-chalkboard-user"></i> <span>STUDENT CLUB</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fa-solid fa-bars-staggered"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fa-solid fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fa-solid fa-box-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fa-solid fa-at"></i> <span>CONTACT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <a href="javascript:location.href = "mailto:nemkin@cs.bme.hu"" aria-label="email" > <i class="fa-solid fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fa-solid fa-rss"></i> </a> <a href="https://github.com/versenyprogramozas" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fa-brands fa-github"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/"> Home </a> </span> <span> <a href="/news"> News </a> </span> <span>Wish I Knew How to Sort (an exercise in probability)</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1"><header><h1 data-toc-skip>Wish I Knew How to Sort (an exercise in probability)</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1649761200" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 12, 2022 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://cs.bme.hu/~nemkin">Viktória Nemkin</a> </em> </span> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="2704 words" > <em>15 min</em> read</span></div></div></header><div class="content"><p>In this post I would like to talk about solving <a href="https://codeforces.com/problemset/problem/1753/C">Codeforces 1753C: Wish I Knew How to Sort</a>.</p><p>In the exercise we receive a binary array $a$ with $n$ elements, which we want to sort. However, our algorithms teacher forgot to teach us about sorting algorithms. :)</p><p>For lack of a better idea, we choose a randomized method, in which a step looks like the following:</p><ul><li>We point to two positions in the array at random (with uniform distribution, independently of each other and of our previous steps). Let these be denoted by indices $i$ and $j$, where $i &lt; j$.<li>If they are in the wrong order ($a_i &gt; a_j$), we swap them, otherwise we do nothing.</ul><p>This step is repeated until the array is sorted.</p><p><strong>Question</strong>: What is the expectation value of the steps taken?</p><p>In the task, there is a technical detail that the solution must be written as an irreducible fraction (a fraction that can no longer be simplified), I will cover the method of doing this at the end.</p><p>There are at least two very different solutions to the task, both of which are very useful to know for handling probabilistic exercises.</p><h2 id="observation"><span class="me-2">Observation</span><a href="#observation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The first thing we can observe is that we know how many $0$s and $1$s are in the $a$ array, so we can already draw the borer between the $0$s and the $1$s in the resulting, sorted array.</p><p><a href="/assets/posts/2022-04-12-wish-i-knew-how-to-sort/divider_line.png" class="popup img-link shimmer"><img src="/assets/posts/2022-04-12-wish-i-knew-how-to-sort/divider_line.png" alt="Divider line" loading="lazy"></a></p><p>Then, based on the location of the randomly chosen pair $i &lt; j$, there are actually two different cases:</p><ol><li>$i$ is before the dividing line, $j$ is after it.<li>Both are before or after the dividing line.</ol><p>In the first case, if there is a swap, we have done useful work, since we have increased the number of $0$s before the line and the number of $1$s after the line, bringing us closer to the desired state.</p><p><a href="/assets/posts/2022-04-12-wish-i-knew-how-to-sort/useful_work.png" class="popup img-link shimmer"><img src="/assets/posts/2022-04-12-wish-i-knew-how-to-sort/useful_work.png" alt="Useful work" loading="lazy"></a></p><p>In the second case, if there is a swap, we did not do useful work with it, since we only moved things within the border, we still have to move the same amount of $1$s from the left side of the border to the right side and replace them with $0$s.</p><p><a href="/assets/posts/2022-04-12-wish-i-knew-how-to-sort/useless_work.png" class="popup img-link shimmer"><img src="/assets/posts/2022-04-12-wish-i-knew-how-to-sort/useless_work.png" alt="Useless work" loading="lazy"></a></p><p>So it can be said that the exact location of the $0$s and $1$s is irrelevant, the only thing that matters is how many of them are on either side of the boundary line. A useful step occurs only when $i$ is before the boundary and $j$ is after the boundary, and $a_i = 1$ and $a_j = 0$. In all other cases, the step does not change the current state.</p><h2 id="first-method-geometric-distribution-and-linearity-of-the-expectation-value"><span class="me-2">First method: Geometric distribution and linearity of the expectation value</span><a href="#first-method-geometric-distribution-and-linearity-of-the-expectation-value" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>If you know probability theory, you may recognize a notable distribution in the task: this is the geometric distribution. This appears when we “repeat something until something occurs”.</p><h3 id="a-little-detour-about-the-geometric-distribution-for-those-who-dont-know-it-yet"><span class="me-2">A little detour: about the geometric distribution (for those who don’t know it yet)</span><a href="#a-little-detour-about-the-geometric-distribution-for-those-who-dont-know-it-yet" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>More precisely:</p><ol><li>We perform a series of random experiments.<li>Among the possible outcomes of the experiments, we distinguish between “successful” and “failed” outcomes.<ul><li>We call a set of outcomes an event, so we have a “successful” and a “failed” event.<li>The probability of the “successful” event is known, let’s denote it by $p$, the probability of the “failed” event is therefore $1-p$.</ul><li>The individual experiments are performed independently of each other (i.e. the probability of success is not affected by the results of the previous experiments).<li>We stop when we get a successful result.<li>We define a random variable that tells us how many steps we took before we stopped.</ol><p>For example, if the variable $X$ represents the number of steps, we can ask what the probability is that exactly $i$ steps were taken, i.e. $P(X=i) = ?$.</p><p>This requires $i-1$ failed attempts and $1$ successful attempt, so</p><p>\(P(X=i) = (1-p)^{i-1}p\).</p><p>And the possible values of $i$ are any number of steps between $1$ and $\infty$.</p><p>The advantage of knowing notable distributions is, for example, that we know their expectation value. We denote this for the variable $X$ by $E(X)$. By definition, the expectation value is the sum of the possible values of a variable weighted by their probability, i.e</p>\[E(X) = \sum\limits_{i} i \cdot{} P(X=i).\]<p>(We can later talk about the fact that if we sample $X$ many times, i.e. carry out the series of random experiments and write down how many steps we took, then the average of the obtained step numbers will get closer and closer to this theoretical expectation value, but now we are in the territory of statistics. )</p><h4 id="the-expectation-value-of-the-geometric-distribution"><span class="me-2">The expectation value of the geometric distribution</span><a href="#the-expectation-value-of-the-geometric-distribution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The theoretical expectation value of the geometric distribution is $\frac{1}{p}$, which can be easily calculated by substituting into the formula above:</p>\[E(X) = \sum\limits_{i} i \cdot{} P(X=i) = \sum\limits_{i} i \cdot{} (1-p)^{i-1}p = p \sum\limits_{i=1}^{\infty} i \cdot{} (1-p)^{i-1}\]<p>We have come across such infinite sums many times and they can be dealt with in many ways. Now we are mainly bothered by the $i$ multiplier, without which we would have a geometric series, so we should get rid of it.</p><p>For example, we start from the original equality and see what it looks like if we start to expand it:</p>\[E(X) = p \sum\limits_{i=1}^{\infty} i \cdot{} (1-p)^{i-1} = p + 2p(1-p) + 3p(1-p)^2 + 4p(1-p)^3 + \cdots{}\]<p>Multiply both sides by $(1-p)$:</p>\[(1-p) E(X) = p \sum\limits_{i=1}^{\infty} i \cdot{} (1-p)^{i} = p(1-p) + 2p(1-p)^2 + 3p(1-p)^3 + 4p(1-p)^4 + \cdots{}\]<p>We notice that if we subtract the two from each other, we can get rid of the $i$ multipliers and get the sum of an infinite geometric series:</p>\[E(X) - (1-p) E(X) = p + p(1-p) + p(1-p)^2 + p(1-p)^3 + p(1-p)^4 + \cdots{} = p \sum\limits_{i=0}^{\infty} (1-p)^{i} = p \cdot{} \frac{1}{1-(1-p)} = 1\]<p>So</p>\[E(X) - E(X) + pE(X) = 1,\] \[pE(X) = 1,\] \[E(X) = \frac{1}{p}.\]<p>It is worth remembering this result.</p><h3 id="back-to-the-task"><span class="me-2">Back to the task</span><a href="#back-to-the-task" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>There is some kind of “do it until we succeed” feeling about the task, so we believe there is some geometric random variable in the background, the expectation value of which we now know. Let’s try to model the task in this way!</p><p>It is quickly seen that a single variable is not enough to model the problem. Let’s think about it: then the stopping condition would be that the array has become sorted, for which a fixed probability $p$ would have to be determined, which should also be the same in each step, since the steps are independent. It won’t work that way. The steps are not independent this way.</p><p>Instead, we can distribute the steps among several random variables: let the successful event be the one when our randomly chosen indices $i$ and $j$ fall on different sides of the boundary line and a swap is performed. There will be more than one of this event, which means we will need more than one random variables. However, fortunately, we can already tell from the initial array $a$ exactly how many variables are needed: as many successful events as are needed, i.e. how many $1$s are on the left side of the boundary: let’s denote this number with $k$ !</p><p>Then the number of steps needed can be described as the sum of $k$ variables. Let $X_i$ be the variable that describes the number of steps needed to move from $i$ to $i-1$ number of $1$s on the left side (so that the last step was the only successful and useful swap in the sequence of steps needed).</p><p>Then the number of steps can be described by the sum of the variables $X_k + X_{k-1} + \cdots{} + X_1$, we need to calculate the expectation value of this sum, i.e. $E(X_k + X_{k-1} + \cdots{} + X_1)$.</p><p>Here we use a very important theorem, the <strong>linearity of expectation</strong>, i.e</p>\[E(X_k + X_{k-1} + \cdots{} + X_1) = E(X_k) + E(X_{k-1}) + \cdots{} + E(X_1).\]<p>What is very surprising in this formula is that it is true even if the individual variables are <strong>not independent</strong> of each other and there are competitive programming tasks that strongly depend on this property. This is not the case now, here our variables will be independent, so this is perhaps less surprising, but for those of you, more interested in the topic, you can read about it here, for example: https://brilliant.org/wiki/linearity-of-expectation/.</p><p>Then we only need to give a formula for $E(X_i)$. If there $i$ number of $1$s on the left side, then the probability of a successful swap, $p_i$ can be given with the formula favourable / total number of cases as follows:</p><ul><li>Since the array has $n$ elements, the total number of cases is how many ways I can choose an ordered pair of indices from the elements, this is $\binom{n}{2}$.<li>The number of favourable cases is how many ways I can choose a $1$ on the left side of the boundary and a $0$ on the right side.<li>If there are $i$ pieces of $1$s on the left side, it means that there are the same number of $0$s on the right side, and we want to choose a pair of them, so $i\cdot{}i = i^2$ is the number of favourable cases.</ul><p>So</p>\[p_i = \frac{i^2}{\binom{n}{2}}.\]<p>And it follows that the expectation value of a variable</p>\[E(X_i) = \frac{1}{p_i} = \frac{\binom{n}{2}}{i^2}.\]<p>And the expectation value of the sum is</p>\[E = E(X_k) + E(X_{k-1}) + \cdots{} + E(X_1) = \sum\limits_{i=1}^{k}\frac{\binom{n}{2}}{i^2}.\]<p>At this point, we have solved the problem on a theoretical level, the only thing left to do is calculating this sum programatically.</p><p>Before we do that, let’s first look at a completely different solution:</p><h2 id="second-method-markov-chain-hitting-times-with-dynamic-programming"><span class="me-2">Second method: Markov chain hitting times with dynamic programming</span><a href="#second-method-markov-chain-hitting-times-with-dynamic-programming" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="a-little-detour-about-markov-chains-for-those-who-dont-know-it-yet"><span class="me-2">A little detour: about Markov chains (for those who don’t know it yet)</span><a href="#a-little-detour-about-markov-chains-for-those-who-dont-know-it-yet" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>In probability theory, Markov chains describe random processes that fulfill some kind of memorylessness criteria. Now I’m just going to talk about a special type of these, but for simplicity I’m just going to refer to them as Markov chains.</p><p>For example, imagine a weather model that says:</p><ul><li>If the sun was shining yesterday, there is a $90\%$ probability that the sun will also be shining today.<li>If it rained yesterday, there is a $70\%$ probability that it will also rain today.</ul><p>These statements can be illustrated with a diagram:</p><p><a href="/assets/posts/2022-04-12-wish-i-knew-how-to-sort/weather_markov.png" class="popup img-link shimmer"><img src="/assets/posts/2022-04-12-wish-i-knew-how-to-sort/weather_markov.png" alt="Weather Markov chain" loading="lazy"></a></p><p>This is an example of a very simple Markov chain. The chain has $2$ possible states, “sunny” and “rainy”. The random variable $X_i$ indicates the weather on day $i$. The above statements can be translated into the language of probability, with which we can specify the state transition probabilities of the chain:</p><ul><li>The probability that the weather is sunny on day $i$, provided that it was also sunny on the previous day, $i-1$: $P(X_i = sunny \vert X_{i-1} = sunny) = 0.9$<li>The probability that the weather is rainy on day $i$, provided that it was sunny on the previous day, $i-1$: $P(X_i = rainy \vert X_{i-1} = sunny) = 0.1$<li>The probability that the weather is sunny on day $i$, provided that it was rainy on the previous day, $i-1$: $P(X_i = sunny \vert X_{i-1} = rainy) = 0.3$<li>The probability that the weather is rainy on day $i$, provided that it was also rainy on the previous day, $i-1$: $P(X_i = rainy \vert X_{i-1} = rainy) = 0.7$</ul><p>This can be described in a concise way by the transition probability matrix (usually denoted by $\Pi$):</p><p><a href="/assets/posts/2022-04-12-wish-i-knew-how-to-sort/weather_transition_matrix.png" class="popup img-link shimmer"><img src="/assets/posts/2022-04-12-wish-i-knew-how-to-sort/weather_transition_matrix.png" alt="Transition probability matrix" loading="lazy"></a></p><p>The matrix is stochastic, meaning that the sum of any column is $1$, since it is partition of the sample space:</p><ul><li>The events are pairwise disjoint, since according to our model there can only be one type of weather on a day.<li>Their union is the entire sample space, since according to our model there is some kind of weather every day.</ul><p>The memorylessness condition (or the so-called Markov condition) here means that the weather of a given day depends only on the weather of the previous day, “not on the weather of any other past days”. This latter description worded mathematically correctly goes: if yesterday’s weather is known, today’s weather is independent of the weather of all other previous days.</p><h3 id="back-to-the-task-1"><span class="me-2">Back to the task</span><a href="#back-to-the-task-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>In our exercise, we can recognize a similar Markov chain. The states of this should correspond to the number of $1$s on the left side of the boundary. We know that the possible values are $0, \dots{}, k$, where $k$ is the value belonging to the starting array.</p><p>We have previously specified the $p_i$ probabilities, which will be the transitional probabilities of this chain:</p><p><a href="/assets/posts/2022-04-12-wish-i-knew-how-to-sort/sort_markov.png" class="popup img-link shimmer"><img src="/assets/posts/2022-04-12-wish-i-knew-how-to-sort/sort_markov.png" alt="Markov chain of the sorting task" loading="lazy"></a></p><p>Now the question is, what is the expectation number of steps until the chain reaches from state $k$ to state $0$?</p><p>This is the so-called “hitting time” of the chain.</p><p>It can be derived in general [1], as follows: [1]: https://mpaldridge.github.io/math2750/S08-hitting-times.html</p><p>Let’s denote by $\nu_{j\leftarrow{}i} = \nu_{j,i}$ that if the current state of the Markov chain is $i$, then what is the expectation value of the number of steps before it first reaches state $j$.</p><ul><li>If $i = j$, then $\nu_{i,i} = 0$.<li>In any other case, at least one step is required to reach state $j$.<ul><li>This one step will enter another state $s$, according to the probabilities written on the outgoing edges of state $i$.<li>This other state $s$ also has some hitting time towards the target state.<li>Due to the linearity of expectation, the following “self-referential formula” can be given:<ul><li>$S$ denotes the set of possible states.<li>$p_{s,i}$ denotes value written in the transition probability matrix in row $s$ and column $i$, i.e. the probability of moving from state $i$ to state $s$.</ul></ul></ul>\[\nu_{j,i} = 1 + \sum\limits_{s\in{}S} \nu_{j,s}p_{s,i}\]<p>Here we used the <a href="https://en.wikipedia.org/wiki/Law_of_total_expectation">Law of total expectation</a>.</p><p>This results in a very nice dynamic programming solution for our Markov chain.</p><ul><li>Since we want to reach state $0$, the only question is which state we came from, denote this with $k$.<li>Let $dp[k]$ denote the hitting time from state $k$ to $0$.<li>We know that in the case of $k\neq{}0$, at least one step must be taken.<li>This step can be unsuccessful (with probability $1-p_k$) or successful (with probability $p_k$).<li>Substitute this into the general formula above:</ul>\[dp[k] = 1 + (1-p_k) dp[k] + p_k dp[k-1]\]<ul><li>And rearrange:</ul>\[p_k \cdot{} dp[k] = 1 + p_k \cdot{} dp[k-1]\] \[dp[k] = \frac{1}{p_k} + dp[k-1]\]<ul><li>Furthermore:</ul>\[dp[0] = 0\]<p>This clearly shows that</p>\[dp[k] = \sum\limits_{i=1}^{k} \frac{1}{p_k}\]<p>Which is exactly the same formula that we derived from the geometric distribution solution! :)</p><h2 id="printing-the-solution-as-an-irreducible-fraction"><span class="me-2">Printing the solution as an irreducible fraction</span><a href="#printing-the-solution-as-an-irreducible-fraction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>In the case of the first method, the following sum must be calculated:</p>\[E = \sum\limits_{i=1}^{k}\frac{\binom{n}{2}}{i^2} = \frac{n(n-1)}{2}\sum\limits_{i=1}^{k}\frac{1}{i^2}\]<p>Let’s bring the fractions in the sum to a common denominator!</p><p>Let $D$ be the common denominator!</p>\[D = \prod\limits_{i=1}^{k}i^2\] \[E = \frac{n(n-1)}{2} \frac{\sum\limits_{i=1}^{k}\frac{D}{i^2}}{D} = \frac{P}{Q}\]<p>This is good for us, because the numerator and denominator of this fraction must be integer, so we can calculate them separately:</p>\[P = n(n-1) \sum\limits_{i=1}^{k}\frac{D}{i^2}\] \[Q = 2D\]<p>And in Python, the third parameter of the <code class="language-plaintext highlighter-rouge">pow</code> function is the modulo, so the inverse of $Q$ with the modulo can be determined with it to calculate $\frac{P}{Q}$.</p><p>Source code:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre><span class="n">cases</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="nf">input</span><span class="p">())</span>
   
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">cases</span><span class="p">):</span>
     
  <span class="n">n</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="nf">input</span><span class="p">())</span>
  <span class="n">a</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="nf">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nf">input</span><span class="p">().</span><span class="nf">split</span><span class="p">()))</span>
     
  <span class="n">border</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># Where is the border between the 0s and 1s of the final result.
</span>  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">border</span> <span class="o">+=</span> <span class="mi">1</span>
        
  <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># The number of 1's before the border, that need to be swapped to the other side.
</span>  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">border</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
      <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>

  <span class="k">if</span> <span class="n">k</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">continue</span>

  <span class="n">D</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">D</span> <span class="o">*=</span> <span class="n">i</span><span class="o">*</span><span class="n">i</span>

  <span class="n">S</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">S</span> <span class="o">+=</span> <span class="n">D</span> <span class="o">/</span> <span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span>
  <span class="n">P</span> <span class="o">=</span> <span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">S</span>

  <span class="n">Q</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">D</span>

  <span class="n">mod</span> <span class="o">=</span> <span class="mi">998244353</span>
  <span class="n">QInv</span> <span class="o">=</span> <span class="nf">pow</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">mod</span><span class="p">)</span>
  
  <span class="nf">print</span><span class="p">(</span><span class="nf">int</span><span class="p">((</span><span class="n">P</span> <span class="o">*</span> <span class="n">QInv</span><span class="p">)</span> <span class="o">%</span> <span class="n">mod</span><span class="p">))</span>
</pre></table></code></div></div><p>And this results in a time limit exceeded at the moment. :) (TODO)</p></div><div class="post-tail-wrapper text-muted pt-5"><div class="post-meta"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/codeforces/">codeforces</a>, <a href="/categories/probability-theory/">probability-theory</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-2 pb-2"><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/codeforces/" class="post-tag no-text-decoration" >codeforces</a> <a href="/tags/probability-theory/" class="post-tag no-text-decoration" >probability-theory</a> <a href="/tags/expectation-value/" class="post-tag no-text-decoration" >expectation-value</a> <a href="/tags/markov-chain/" class="post-tag no-text-decoration" >markov-chain</a></div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted me-1">Share</span> <span class="share-icons"> <a href="https://www.facebook.com/sharer/sharer.php?title=Wish%20I%20Knew%20How%20to%20Sort%20(an%20exercise%20in%20probability)%20-%20VProg&u=https%3A%2F%2Fvprog.hu%2Fposts%2F2022-04-12-wish-i-knew-how-to-sort%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook" > <i class="fa-fw fa-brands fa-square-facebook"></i> </a> <a href="https://twitter.com/intent/tweet?text=Wish%20I%20Knew%20How%20to%20Sort%20(an%20exercise%20in%20probability)%20-%20VProg&url=https%3A%2F%2Fvprog.hu%2Fposts%2F2022-04-12-wish-i-knew-how-to-sort%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter" > <i class="fa-fw fa-brands fa-square-twitter"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fvprog.hu%2Fposts%2F2022-04-12-wish-i-knew-how-to-sort%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin" > <i class="fa-fw fa-brands fa-linkedin"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fvprog.hu%2Fposts%2F2022-04-12-wish-i-knew-how-to-sort%2F&text=Wish%20I%20Knew%20How%20to%20Sort%20(an%20exercise%20in%20probability)%20-%20VProg" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram" > <i class="fa-fw fa-brands fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted"><div class="access"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/vprog/">vprog</a> <a class="post-tag btn btn-outline-primary" href="/tags/vprog-intro/">vprog-intro</a> <a class="post-tag btn btn-outline-primary" href="/tags/starting/">starting</a> <a class="post-tag btn btn-outline-primary" href="/tags/solutions/">solutions</a> <a class="post-tag btn btn-outline-primary" href="/tags/video/">video</a> <a class="post-tag btn btn-outline-primary" href="/tags/binsearch/">binsearch</a> <a class="post-tag btn btn-outline-primary" href="/tags/codeforces/">codeforces</a> <a class="post-tag btn btn-outline-primary" href="/tags/twoptr/">twoptr</a> <a class="post-tag btn btn-outline-primary" href="/tags/codejam/">codejam</a> <a class="post-tag btn btn-outline-primary" href="/tags/dfs/">dfs</a></div></section></div><section id="toc-wrapper" class="ps-0 pe-4"><h2 class="panel-heading ps-3 pt-2 mb-2">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/2024-08-10-non-academic-problem/" class="post-preview card h-100"><div class="card-body"> <time class="small" data-ts="1723312440" data-df="ll" > Aug 10, 2024 </time><h4 class="pt-0 my-2">Non-academic problem (Bridge Finding)</h4><div class="text-muted small"><p> In CF 1986F: Non-academic problem we are given a simple undirected graph. The graph is connected, meaning that every vertex can be reached from every other vertex. Our task is to ruin this property...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/2021-04-16-google-code-jam-qualification-round/" class="btn btn-outline-primary" aria-label="Older" ><p>Google Code Jam 2021 - Qualification Round</p></a> <a href="/posts/2022-09-01-vprog-start/" class="btn btn-outline-primary" aria-label="Newer" ><p>VProg Student Club</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>Using the <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/vprog/">vprog</a> <a class="post-tag btn btn-outline-primary" href="/tags/vprog-intro/">vprog-intro</a> <a class="post-tag btn btn-outline-primary" href="/tags/starting/">starting</a> <a class="post-tag btn btn-outline-primary" href="/tags/solutions/">solutions</a> <a class="post-tag btn btn-outline-primary" href="/tags/video/">video</a> <a class="post-tag btn btn-outline-primary" href="/tags/binsearch/">binsearch</a> <a class="post-tag btn btn-outline-primary" href="/tags/codeforces/">codeforces</a> <a class="post-tag btn btn-outline-primary" href="/tags/twoptr/">twoptr</a> <a class="post-tag btn btn-outline-primary" href="/tags/codejam/">codejam</a> <a class="post-tag btn btn-outline-primary" href="/tags/dfs/">dfs</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask"></div><script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/en.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js,npm/tocbot@4.21.1/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { /* start/end delimiter pairs for in-line math */ inlineMath: [ ['$', '$'], ['\\(', '\\)'] ], /* start/end delimiter pairs for display math */ displayMath: [ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-chtml.js"></script> <script defer src="/unregister.js"></script> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
